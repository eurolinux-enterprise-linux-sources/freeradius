From 362533a64646cce89799ba0759d4304b8de1e917 Mon Sep 17 00:00:00 2001
From: "Alan T. DeKok" <aland@freeradius.org>
Date: Tue, 7 Mar 2017 09:22:10 -0500
Subject: [PATCH] radtest should use Cleartext-Password for EAP

(cherry picked from commit 0251c6c9d049f06c8f10974f9e67ef8142b17047)
---
 src/main/radtest.in                | 2 +-
 src/modules/rlm_eap/radeapclient.c | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/main/radtest.in b/src/main/radtest.in
index 7f009ae68..38b1ba9a0 100644
--- a/src/main/radtest.in
+++ b/src/main/radtest.in
@@ -81,7 +81,7 @@ do
 				PASSWORD="MS-CHAP-Password"
 				;;
 			eap-md5)
-				PASSWORD="User-Password"
+				PASSWORD="Cleartext-Password"
 				if [ ! -x "$radeapclient" ]
 				then
 				    echo "radtest: No 'radeapclient' program was found.  Cannot perform EAP-MD5." >&1
diff --git a/src/modules/rlm_eap/radeapclient.c b/src/modules/rlm_eap/radeapclient.c
index 020d252f1..ff69361e4 100644
--- a/src/modules/rlm_eap/radeapclient.c
+++ b/src/modules/rlm_eap/radeapclient.c
@@ -468,6 +468,7 @@ static int rc_init_packet(rc_transaction_t *trans)
 		/*
 		 *	Keep a copy of the the password attribute.
 		 */
+		case PW_CLEARTEXT_PASSWORD:
 		case PW_USER_PASSWORD:
 		case PW_CHAP_PASSWORD:
 		case PW_MS_CHAP_PASSWORD:
-- 
2.11.0


From 66e6706039677c364f1181ed3c5620fee59a38e1 Mon Sep 17 00:00:00 2001
From: "Alan T. DeKok" <aland@freeradius.org>
Date: Fri, 2 Jun 2017 09:10:05 -0400
Subject: [PATCH] parse port.  Closes #2000

(cherry picked from commit 66c109361ef67906f52fe2d441f6b61ec2492f32)
---
 src/modules/proto_dhcp/dhcpclient.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/src/modules/proto_dhcp/dhcpclient.c b/src/modules/proto_dhcp/dhcpclient.c
index 5c923f136..adbcb8c9d 100644
--- a/src/modules/proto_dhcp/dhcpclient.c
+++ b/src/modules/proto_dhcp/dhcpclient.c
@@ -413,10 +413,11 @@ int main(int argc, char **argv)
 	 */
 	server_ipaddr.af = AF_INET;
 	if (strcmp(argv[1], "-") != 0) {
-		if (ip_hton(&server_ipaddr, AF_INET, argv[1], false) < 0) {
-			fr_perror("dhcpclient");
-			fr_exit_now(1);
+		if (fr_pton_port(&server_ipaddr, &server_port, argv[1], -1, AF_INET, true) < 0) {
+			fprintf(stderr, "dhcpclient: Failed parsing IP:port - %s", fr_strerror());
+			exit(1);
 		}
+
 		client_ipaddr.af = server_ipaddr.af;
 	}
 
-- 
2.11.0

